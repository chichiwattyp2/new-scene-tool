!function(e){function t(t){for(var o,s,a=t[0],c=t[1],l=t[2],d=0,h=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(u&&u(t);h.length;)h.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={0:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;r.push([8,1]),n()}([,,,function(e,t){e.exports='<!doctype html> <html lang=en> <head> <meta charset=UTF-8> <meta name=viewport content="width=device-width,initial-scale=1"> <link rel="shortcut icon" href=""> <title>Sandcastle</title> </head> <body> <div class=info></div> <div class=app></div> </body> </html>'},function(e,t,n){var o=n(5),i=n(6);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};o(i,r);e.exports=i.locals||{}},,function(e,t,n){(t=n(7)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200&display=swap);"]),t.push([e.i,"body \r\n{\r\n    font-family: 'Montserrat', sans-serif;\r\n    font-size:1.25em;\r\n    overflow: hidden; \r\n}\r\n\r\n.info \r\n{\r\n    width: 100%; \r\n    z-index: 9; \r\n    position: absolute;\r\n    bottom: 4em;\r\n    text-align: center;\r\n}\r\n\r\n.app\r\n{\r\n    width: 100%;\r\n    height: 100%;            \r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n}\r\n\r\na \r\n{\r\ncolor: hotpink;\r\n}",""]),e.exports=t},,function(e,t,n){"use strict";n.r(t);n(3),n(4);var o=n(0),i=new o.fb;function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}i.init=function(){i.traverse((function(e){i.remove(e)}));for(var e=[new o.rb(-1,0,0),new o.rb(1,1,0),new o.rb(0,-1,0)],t=function(){var t=new o.I(new o.nb(1,.05,16,32),new o.K({wireframe:!0}));t.position.z-=5,t.scale.set(1-.33*n,1-.33*n,1-.33*n);var r=new o.rb;r.copy(e[n]),t.Update=function(){t.rotateOnAxis(r,.007)},i.add(t)},n=0;n<3;n++)t()},i.init();var c=function(){function e(t){r(this,e),this.name=t,this.callbacks=[]}return a(e,[{key:"registerCallback",value:function(e){this.callbacks.push(e)}}]),e}(),l=function(){function e(){r(this,e),this.events={}}return a(e,[{key:"registerEvent",value:function(e){var t=new c(e);this.events[e]=t}},{key:"dispatchEvent",value:function(e,t){this.events[e].callbacks.forEach((function(e){e(t)}))}},{key:"addEventListener",value:function(e,t){this.events[e].registerCallback(t)}}]),e}(),u=new(function(){function e(){r(this,e),this.isXRSession=!1,this.isPaused=!1,this.currentSession=null,this.debugPhysics=!0,this.eventHandler=new l,this.eventHandler.registerEvent("xrsessionstarted"),this.eventHandler.registerEvent("xrsessionended"),this.eventHandler.registerEvent("peerconnected"),this.eventHandler.registerEvent("peerdisconnected"),this.bindDebugKeys()}return a(e,[{key:"bindDebugKeys",value:function(){var e=this;document.addEventListener("keydown",(function(t){if(t.shiftKey)switch(t.keyCode){case 192:e.debugPhysics=!e.debugPhysics,console.log("Physics Debug: "+e.debugPhysics);break;case 80:e.isPaused=!e.isPaused,console.log("Paused: "+e.isPaused)}}))}}]),e}());function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(s,e);var t,n,i,r=f(s);function s(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(i=r.call(this,n)).camera=e,i.domElement=t,i.PI_2=Math.PI/2,i.euler=new o.l(0,0,0,"YXZ"),i.vec=new o.rb,i.cameraForward=new o.rb,i._rcPressed=!1,i.pressedKeyMap={87:!1,65:!1,83:!1,68:!1,81:!1,69:!1,16:!1},window.addEventListener("keydown",i.onKeyDown.bind(v(i)),!1),window.addEventListener("keyup",i.onKeyUp.bind(v(i)),!1),window.addEventListener("mousedown",i.onMouseDown.bind(v(i)),!1),window.addEventListener("mouseup",i.onMouseUp.bind(v(i)),!1),window.addEventListener("mousemove",i.onMouseMove.bind(v(i)),!1),window.addEventListener("wheel",i.onMouseWheel.bind(v(i)),!1),document.oncontextmenu=function(e){null!=e.preventDefault&&e.preventDefault(),null!=e.stopPropagation&&e.stopPropagation()},i.retrieveSessionData(),i}return t=s,(n=[{key:"setSessionData",value:function(){this.editorCamState={camSpeed:this.CAM_SPEED,cameraPosition:this.camera.position,cameraQuaternion:this.camera.quaternion},window.sessionStorage.setItem("camState",JSON.stringify(this.editorCamState))}},{key:"retrieveSessionData",value:function(){var e=JSON.parse(window.sessionStorage.getItem("camState"));if(null==e)return this.CAM_SPEED=.75,void this.setSessionData();this.CAM_SPEED="camSpeed"in e?e.camSpeed:.75,this.camera.position.copy("cameraPosition"in e?e.cameraPosition:new o.rb),this.camera.applyQuaternion("cameraQuaternion"in e?e.cameraQuaternion:new o.rb)}},{key:"Update",value:function(){this.shiftSpeedMulti=this.pressedKeyMap[16]?2:1,this.pressedKeyMap[87]&&this.moveForward(this.CAM_SPEED*this.shiftSpeedMulti),this.pressedKeyMap[83]&&this.moveForward(-this.CAM_SPEED*this.shiftSpeedMulti),this.pressedKeyMap[69]&&this.moveUp(this.CAM_SPEED*this.shiftSpeedMulti),this.pressedKeyMap[81]&&this.moveUp(-this.CAM_SPEED*this.shiftSpeedMulti),this.pressedKeyMap[68]&&this.moveRight(this.CAM_SPEED*this.shiftSpeedMulti),this.pressedKeyMap[65]&&this.moveRight(-this.CAM_SPEED*this.shiftSpeedMulti)}},{key:"onKeyDown",value:function(e){this.pressedKeyMap[e.keyCode]=e.keyCode in this.pressedKeyMap}},{key:"onKeyUp",value:function(e){this.pressedKeyMap[e.keyCode]=!(e.keyCode in this.pressedKeyMap)}},{key:"onMouseDown",value:function(e){2==e.button&&(this._rcPressed=!0,this.domElement.requestPointerLock=this.domElement.requestPointerLock||domElement.mozRequestPointerLock,this.domElement.requestPointerLock())}},{key:"onMouseUp",value:function(e){2==e.button&&(this._rcPressed=!1,document.exitPointerLock(),this.setSessionData())}},{key:"moveForward",value:function(e){this.camera.getWorldDirection(this.cameraForward),this.camera.position.addScaledVector(this.cameraForward,e)}},{key:"moveRight",value:function(e){this.vec.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(this.vec,e)}},{key:"moveUp",value:function(e){this.camera.position.addScaledVector(this.camera.up,e)}},{key:"onMouseMove",value:function(e){if(this._rcPressed){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;this.euler.setFromQuaternion(this.camera.quaternion),this.euler.y-=.002*t,this.euler.x-=.002*n,this.euler.x=Math.max(-this.PI_2,Math.min(this.PI_2,this.euler.x)),this.camera.quaternion.setFromEuler(this.euler)}}},{key:"onMouseWheel",value:function(e){this._rcPressed?this.CAM_SPEED=Math.max(.01,this.CAM_SPEED-=1e-4*e.deltaY):this.moveForward(this.CAM_SPEED*-e.deltaY/10)}}])&&h(t.prototype,n),i&&h(t,i),s}(o.S);function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var w=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t;var o=this;if(this.showEnterVR=this.showEnterVR.bind(this),n&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.'),"xr"in navigator)return this.button=document.createElement("this.button"),this.button.style.display="none",this.stylizeElement(this.button),navigator.xr.isSessionSupported("immersive-vr").then((function(e){e?o.showEnterVR():o.showWebXRNotFound()})),this.button;var i=document.createElement("a");return!1===window.isSecureContext?(i.href=document.location.href.replace(/^http:/,"https:"),i.innerHTML="WEBXR NEEDS HTTPS"):(i.href="https://immersiveweb.dev/",i.innerHTML="WEBXR NOT AVAILABLE"),i.style.left="calc(50% - 90px)",i.style.width="180px",i.style.textDecoration="none",this.stylizeElement(i),i}var t,n,o;return t=e,(n=[{key:"showEnterVR",value:function(){var e=this,t=null,n=function(n){n.addEventListener("end",o),e.renderer.xr.setSession(n),u.eventHandler.dispatchEvent("xrsessionstarted",n),e.button.textContent="EXIT VR",t=n},o=function n(){t.removeEventListener("end",n),u.eventHandler.dispatchEvent("xrsessionended"),e.button.textContent="ENTER VR",t=null};this.button.style.display="",this.button.style.cursor="pointer",this.button.style.left="calc(50% - 50px)",this.button.style.width="100px",this.button.style.background="black",this.button.textContent="ENTER VR",this.button.onmouseenter=function(){e.button.style.opacity="1.0"},this.button.onmouseleave=function(){e.button.style.opacity="0.5"},this.button.onclick=function(){null===t?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}).then(n):t.end()}}},{key:"disableButton",value:function(){this.button.style.display="",this.button.style.cursor="auto",this.button.style.left="calc(50% - 75px)",this.button.style.width="150px",this.button.onmouseenter=null,this.button.onmouseleave=null,this.button.onclick=null}},{key:"showWebXRNotFound",value:function(){this.disableButton(),this.button.textContent="VR NOT SUPPORTED"}},{key:"stylizeElement",value:function(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}}])&&g(t.prototype,n),o&&g(t,o),e}(),S=new o.tb({antialias:!0,alpha:!0});S.setPixelRatio(window.devicePixelRatio),S.setSize(window.innerWidth,window.innerHeight),S.setClearColor(0,0),S.sortObjects=!1,S.physicallyCorrectLights=!0,S.xr.enabled=!0;var E=n(1);function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var k=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=i||{},this.scene=t,this.world=n,this._meshes=[],this._material=new o.J({color:65280,wireframe:!0}),this._sphereGeometry=new o.jb(1),this._boxGeometry=new o.d(1,1,1),this._planeGeometry=new o.V(10,10,10,10),this._cylinderGeometry=new o.i(1,1,10,10),this.tmpVec0=new E.Vec3,this.tmpVec1=new E.Vec3,this.tmpVec2=new E.Vec3,this.tmpQuat0=new E.Vec3}var t,n,i;return t=e,(n=[{key:"update",value:function(e){var t=this;if(e){for(var n=this.world.bodies,o=this._meshes,i=this.tmpVec0,r=this.tmpQuat0,s=0,a=0;a!==n.length;a++)for(var c=n[a],l=0;l!==c.shapes.length;l++){var u=c.shapes[l];this._updateMesh(s,c,u),(d=o[s])&&(c.quaternion.vmult(c.shapeOffsets[l],i),c.position.vadd(i,i),c.quaternion.mult(c.shapeOrientations[l],r),d.position.copy(i),d.quaternion.copy(r)),s++}for(a=s;a<o.length;a++){var d;(d=o[a])&&this.scene.remove(d)}o.length=s}else this._meshes.length>0&&(this._meshes.forEach((function(e){t.scene.remove(e)})),this._meshes.length=0)}},{key:"_updateMesh",value:function(e,t,n){var o=this._meshes[e];this._typeMatch(o,n)||(o&&this.scene.remove(o),o=this._meshes[e]=this._createMesh(n)),this._scaleMesh(o,n)}},{key:"_typeMatch",value:function(e,t){if(!e)return!1;var n=e.geometry;return n instanceof o.jb&&t instanceof E.Sphere||n instanceof o.d&&t instanceof E.Box||n instanceof o.V&&t instanceof E.Plane||n.id===t.geometryId&&t instanceof E.ConvexPolyhedron||n.id===t.geometryId&&t instanceof E.Trimesh||n.id===t.geometryId&&t instanceof E.Heightfield}},{key:"_createMesh",value:function(e){var t,n=this._material;switch(e.type){case E.Shape.types.SPHERE:t=new o.I(this._sphereGeometry,n);break;case E.Shape.types.BOX:t=new o.I(this._boxGeometry,n);break;case E.Shape.types.PLANE:t=new o.I(this._planeGeometry,n);break;case E.Shape.types.CONVEXPOLYHEDRON:for(var i=new o.p,r=0;r<e.vertices.length;r++){var s=e.vertices[r];i.vertices.push(new o.rb(s.x,s.y,s.z))}for(r=0;r<e.faces.length;r++)for(var a=e.faces[r],c=a[0],l=1;l<a.length-1;l++){var u=a[l],d=a[l+1];i.faces.push(new o.m(c,u,d))}i.computeBoundingSphere(),i.computeFaceNormals(),t=new o.I(i,n),e.geometryId=i.id;break;case E.Shape.types.TRIMESH:var h=new o.p,p=this.tmpVec0,f=this.tmpVec1,y=this.tmpVec2;for(r=0;r<e.indices.length/3;r++)e.getTriangleVertices(r,p,f,y),h.vertices.push(new o.rb(p.x,p.y,p.z),new o.rb(f.x,f.y,f.z),new o.rb(y.x,y.y,y.z)),l=h.vertices.length-3,h.faces.push(new o.m(l,l+1,l+2));h.computeBoundingSphere(),h.computeFaceNormals(),t=new o.I(h,n),e.geometryId=h.id;break;case E.Shape.types.HEIGHTFIELD:h=new o.p,p=this.tmpVec0,f=this.tmpVec1,y=this.tmpVec2;for(var v=0;v<e.data.length-1;v++)for(var m=0;m<e.data[v].length-1;m++)for(var b=0;b<2;b++)e.getConvexTrianglePillar(v,m,0===b),p.copy(e.pillarConvex.vertices[0]),f.copy(e.pillarConvex.vertices[1]),y.copy(e.pillarConvex.vertices[2]),p.vadd(e.pillarOffset,p),f.vadd(e.pillarOffset,f),y.vadd(e.pillarOffset,y),h.vertices.push(new o.rb(p.x,p.y,p.z),new o.rb(f.x,f.y,f.z),new o.rb(y.x,y.y,y.z)),r=h.vertices.length-3,h.faces.push(new o.m(r,r+1,r+2));h.computeBoundingSphere(),h.computeFaceNormals(),t=new o.I(h,n),e.geometryId=h.id}return t&&this.scene.add(t),t}},{key:"_scaleMesh",value:function(e,t){switch(t.type){case E.Shape.types.SPHERE:var n=t.radius;e.scale.set(n,n,n);break;case E.Shape.types.BOX:e.scale.copy(t.halfExtents),e.scale.multiplyScalar(2);break;case E.Shape.types.CONVEXPOLYHEDRON:e.scale.set(1,1,1);break;case E.Shape.types.TRIMESH:e.scale.copy(t.scale);break;case E.Shape.types.HEIGHTFIELD:e.scale.set(1,1,1)}}}])&&x(t.prototype,n),i&&x(t,i),e}(),P=n(2);function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var C=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controllerGrips=[S.xr.getControllerGrip(0),S.xr.getControllerGrip(1)],this.controllers=[],this.controllerModelFactory=new P.a}var t,n,o;return t=e,(n=[{key:"onSelectStart",value:function(e){console.log("select started!")}},{key:"onSelectEnd",value:function(e){console.log("select ended!")}},{key:"onSelect",value:function(e){console.log("select event!")}},{key:"onSqueezeStart",value:function(e){console.log("squeeze pressed!")}},{key:"onSqueezeEnd",value:function(e){console.log("squeeze released!")}},{key:"onSqueeze",value:function(e){console.log("squeeze event completed!")}},{key:"onConnected",value:function(e){console.log("onConnected"),this.controllers.push(e.data)}},{key:"onDisconnected",value:function(e){console.log("onDisconnected"),u.controllers=[]}},{key:"CreateControllerModel",value:function(e,t){e.add(this.controllerModelFactory.createControllerModel(e)),t.add(e)}},{key:"Update",value:function(){this.debugOutput()}},{key:"debugOutput",value:function(){var e=this;return this.inputDebugString="",this.controllers.forEach((function(t){t.gamepad.buttons.forEach((function(n,o){1==n.pressed&&(e.inputDebugString+=t.handedness+" controller button "+o+"\n",e.inputDebugString+="value: "+n.value+"\n")})),0==t.gamepad.axes[2]&&0==t.gamepad.axes[3]||(e.inputDebugString+=t.handedness+" joystick:\n",e.inputDebugString+="x: "+t.gamepad.axes[2]+"\n",e.inputDebugString+="y: "+t.gamepad.axes[3]+"\n")})),""==this.inputDebugString?0:console.log(this.inputDebugString)}}])&&M(t.prototype,n),o&&M(t,o),e}());u.eventHandler.addEventListener("xrsessionstarted",(function(e){console.warn("xr session started"),u.currentSession=e,u.isXRSession=!0;for(var t=0;t<2;t++){var n=S.xr.getController(t);n.addEventListener("selectend",C.onSelectEnd.bind(C)),n.addEventListener("selectstart",C.onSelectStart.bind(C)),n.addEventListener("select",C.onSelect.bind(C)),n.addEventListener("squeezestart",C.onSqueezeStart.bind(C)),n.addEventListener("squeezeend",C.onSqueezeEnd.bind(C)),n.addEventListener("connected",C.onConnected.bind(C)),n.addEventListener("disconnected",C.onDisconnected.bind(C))}})),u.eventHandler.addEventListener("xrsessionended",(function(){console.warn("xr session ended"),u.isXRSession=!1}));var R=void 0,_={rigidbodies:new Array,controllerRigidbodies:new Array,RigidBodyType:{Box:1,Sphere:2,Plane:3,Cylinder:4}};_.cannonWorld=new E.World,_.cannonWorld.broadphase=new E.NaiveBroadphase,_.cannonWorld.gravity.set(0,-5,0),_.cannonWorld.solver.iterations=50,_.cannonWorld.solver.tolerance=1e-5,console.log("CannonJS world created");var D=new E.Plane,O=new E.Body({mass:0});O.addShape(D),O.quaternion.setFromAxisAngle(new E.Vec3(1,0,0),-Math.PI/2),_.cannonWorld.add(O),_.rigidbodies.push(O),_.addControllerRigidBody=function(e){var t=new E.Body({mass:0,type:E.Body.KINEMATIC});t.name="Controller "+_.controllerRigidbodies.length+" RigidBody",t.collisionResponse=1,t.addShape(new E.Sphere(.075)),_.cannonWorld.add(t),_.controllerRigidbodies.push(t),_.rigidbodies.push(t),console.log(t.name+" created")},_.enableDebugger=function(e){_.debugRenderer=new k(e,_.cannonWorld)},_.updateControllers=function(){0!=C.controllerGrips.length&&0!=_.controllerRigidbodies.length&&C.controllerGrips.forEach((function(e,t){_.controllerRigidbodies[t].position.copy(C.controllerGrips[t].position),_.controllerRigidbodies[t].quaternion.copy(C.controllerGrips[t].quaternion)}))},_.Update=function(){_.rigidbodies.length<1||(_.cannonWorld.step(1/60),_.updateControllers(),_.cannonWorld.bodies.forEach((function(e,t){_.cannonWorld.bodies[t].type!=E.Body.KINEMATIC&&(_.rigidbodies[t].quaternion.copy(_.cannonWorld.bodies[t].quaternion),_.rigidbodies[t].position.copy(_.cannonWorld.bodies[t].position))})),null!=_.debugRenderer&&_.debugRenderer.update(u.debugPhysics))},_.resetScene=function(){for(var e=_.cannonWorld.bodies,t=e.length;t--;)R.removeBody(e[t])},_.addRigidBody=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.geometry.computeBoundingBox();var i,r=new o.rb;switch(e.geometry.boundingBox.getSize(r),r.divideScalar(2),t){case _.RigidBodyType.Box:i=new E.Box(new E.Vec3(r.x,r.y,r.z));break;case _.RigidBodyType.Sphere:i=new E.Sphere(Math.max(r.x,r.y,r.z));break;case _.RigidBodyType.Plane:i=new E.Plane;break;case _.RigidBodyType.Cylinder:var s=Math.min(r.x,r.y,r.z),a=2*Math.max(r.x,r.y,r.z);i=new E.Cylinder(s,s,a,16);break;default:console.error("Physics.addBody: No matching rigidbody found! See Physics.RigidBody object for options")}var c=new E.Body({mass:n});c.addShape(i),c.position.copy(e.position),c.quaternion.copy(e.quaternion),_.cannonWorld.addBody(c),_.rigidbodies.push(e)};var B=new o.U(75,window.innerWidth/window.innerHeight,.1,1e4);i.add(new b(B,S.domElement)),i.add(B),S.setAnimationLoop((function(){S.render(i,B),u.isXRSession&&C.Update(),u.isPaused||_.Update(),i.traverse((function(e){"function"==typeof e.Update&&e.Update()}))})),document.querySelector(".app").appendChild(S.domElement),document.querySelector(".app").appendChild(new w(S)),window.addEventListener("resize",(function(){B.aspect=window.innerWidth/window.innerHeight,B.updateProjectionMatrix(),S.setSize(window.innerWidth,window.innerHeight)}))}]);